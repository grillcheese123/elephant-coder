{"ts": "2026-02-09T00:40:43Z", "session_id": "full_prompt_parity_20260209a_test_04_elephant_r1", "role": "user", "command": "/code", "run_id": "run_fb3695123d84", "content": "Write tests for baseline mode markers and context manifest fields."}
{"ts": "2026-02-09T00:40:43Z", "session_id": "full_prompt_parity_20260209a_test_04_elephant_r1", "role": "assistant", "command": "/code", "run_id": "run_fb3695123d84", "content": "{\"summary\":\"Write tests for baseline mode markers and context manifest fields.\",\"project\":{\"language\":\"python\"},\"files\":[{\"path\":\"tests/test_context_manifest.py\",\"content\":\"\\\"\\\"\\\"Tests for baseline mode markers and context manifest fields.\\\"\\\"\\\"\\n\\nfrom __future__ import annotations\\n\\nimport importlib.util\\nimport sys\\nfrom pathlib import Path\\n\\n\\ndef _load_cli_module():\\n    root = Path(__file__).resolve().parents[1]\\n    cli_path = root / \\\"scripts\\\" / \\\"elephant_cli.py\\\"\\n    spec = importlib.util.spec_from_file_location(\\\"elephant_cli_local\\\", cli_path)\\n    if spec is None or spec.loader is None:\\n        raise RuntimeError(\\\"Unable to load scripts/elephant_cli.py\\\")\\n    module = importlib.util.module_from_spec(spec)\\n    sys.modules[spec.name] = module\\n    spec.loader.exec_module(module)\\n    return module\\n\\n\\nelephant_cli = _load_cli_module()\\n\\n\\ndef test_baseline_mode_marker_in_context_manifest(tmp_path: Path, monkeypatch):\\n    (tmp_path / \\\"pyproject.toml\\\").write_text(\\\"[project]\\\\nname='tmp'\\\\n\\\", encoding=\\\"utf-8\\\")\\n    elephant_cli.ensure_project_layout(tmp_path)\\n    monkeypatch.setenv(\\\"ELEPHANT_PROJECT_ROOT\\\", str(tmp_path))\\n\\n    args = elephant_cli._parse([\\\"plan\\\", \\\"--cwd\\\", str(tmp_path), \\\"--task\\\", \\\"add feature\\\", \\\"--output\\\", \\\"json\\\"])\\n    code, response = elephant_cli.execute_command(args)\\n\\n    assert code == 0\\n    assert response[\\\"ok\\\"] is True\\n    context_pack = response.get(\\\"context_pack\\\", {})\\n    assert isinstance(context_pack, dict)\\n    assert \\\"baseline_mode\\\" in context_pack\\n    assert context_pack[\\\"baseline_mode\\\"] is True\\n\\n\\ndef test_context_manifest_fields(tmp_path: Path, monkeypatch):\\n    (tmp_path / \\\"pyproject.toml\\\").write_text(\\\"[project]\\\\nname='tmp'\\\\n\\\", encoding=\\\"utf-8\\\")\\n    elephant_cli.ensure_project_layout(tmp_path)\\n    monkeypatch.setenv(\\\"ELEPHANT_PROJECT_ROOT\\\", str(tmp_path))\\n\\n    args = elephant_cli._parse([\\\"plan\\\", \\\"--cwd\\\", str(tmp_path), \\\"--task\\\", \\\"add feature\\\", \\\"--output\\\", \\\"json\\\"])\\n    code, response = elephant_cli.execute_command(args)\\n\\n    assert code == 0\\n    assert response[\\\"ok\\\"] is True\\n    context_pack = response.get(\\\"context_pack\\\", {})\\n    assert isinstance(context_pack, dict)\\n\\n    manifest = context_pack.get(\\\"manifest\\\", {})\\n    assert isinstance(manifest, dict)\\n    assert \\\"generated_at_utc\\\" in manifest\\n    assert \\\"protocol_version\\\" in manifest\\n    assert \\\"task_fingerprint\\\" in manifest\\n    assert \\\"bundle_fingerprint\\\" in manifest\\n    assert \\\"top_modalities\\\" in manifest\\n    assert \\\"bundle_similarity_to_task\\\" in manifest\\n\"}],\"dependencies\":{\"dependencies\":{},\"devDependencies\":{},\"python\":[],\"pythonDev\":[],\"rust\":[],\"go\":[],\"cpp\":[]},\"commands\":[]}"}
