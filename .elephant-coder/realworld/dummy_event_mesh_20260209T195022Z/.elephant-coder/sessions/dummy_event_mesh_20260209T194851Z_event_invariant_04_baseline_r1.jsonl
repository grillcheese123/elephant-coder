{"ts": "2026-02-09T19:51:24Z", "session_id": "dummy_event_mesh_20260209T194851Z_event_invariant_04_baseline_r1", "role": "user", "command": "/code", "run_id": "run_edd8306e5e10", "content": "Create docs/quality/invariants.md describing extension contracts and architectural invariants (registry contract, processor inheritance rules, and repository contract). Keep runtime behavior unchanged."}
{"ts": "2026-02-09T19:51:24Z", "session_id": "dummy_event_mesh_20260209T194851Z_event_invariant_04_baseline_r1", "role": "assistant", "command": "/code", "run_id": "run_edd8306e5e10", "content": "{\"summary\": \"Create docs/quality/invariants.md documenting extension contracts and architectural invariants for registry, processor inheritance, and repository contracts, preserving existing runtime behavior.\", \"project\": {\"language\": \"python\"}, \"files\": [{\"path\": \"docs/quality/invariants.md\", \"content\": \"# Architectural Invariants\\n\\nThis document describes extension contracts and architectural invariants that must be preserved to maintain runtime behavior.\\n\\n## Extension Contracts\\n\\n### Registry Contract\\n\\nThe runtime registry is responsible for managing processor instances and routing work items to appropriate handlers.\\n\\n**Invariants:**\\n- Registry must support dynamic registration of processors by channel.\\n- Registry must raise `LookupError` when no processor supports a given work item's channel.\\n- Registry must return exactly one result per dispatched work item.\\n\\n### Processor Inheritance Rules\\n\\nAll channel-specific processors must inherit from `BaseProcessor` and implement `_deliver`.\\n\\n**Invariants:**\\n- Subclasses must set `supported_channel` class attribute to a non-empty string.\\n- Subclasses must implement `_deliver(item: WorkItem) -> str` with channel-specific side effects.\\n- `supports()` and `process()` behavior from `BaseProcessor` must not be overridden.\\n- Processors must be registered in `event_mesh.processors.__init__.py` exports.\\n\\n### Repository Contract\\n\\nThe repository abstracts persistence of work items.\\n\\n**Invariants:**\\n- `save(item)` must persist without raising exceptions on success.\\n- `get(identifier)` must return `None` for non-existent items.\\n- `list_by_channel(channel)` must return all items matching the channel.\\n- `list_all()` must return all persisted items.\\n\\n## Implementation Requirements\\n\\n- All contracts are defined in `src/event_mesh/contracts/`.\\n- Concrete implementations must strictly adhere to abstract method signatures.\\n- Runtime behavior must remain unchanged; no new exceptions or side effects introduced by extensions.\"}]"}
