{
  "protocol_version": "v1-dummy-cross-module",
  "description": "Synthetic cross-module inheritance benchmark tasks with interface contracts.",
  "tasks": [
    {
      "task_id": "cross_summary_01",
      "category": "analysis",
      "prompt": "Create docs/summary/project_architecture.md. Summarize the repository with a file map, abstract contracts, cross-module interfaces, layered inheritance chain, and dispatch flow. Follow source-code rules and naming. Ensure the file is at least 220 characters.",
      "checks": [
        "uv run --python 3.12 python -c \"from pathlib import Path; import sys; p=Path('docs/summary/project_architecture.md'); text=p.read_text(encoding='utf-8', errors='replace') if p.exists() else ''; low=text.lower(); keys=['deliveryinterface','channelboundprocessor','reliableprocessor','baseprocessor','dispatcher']; hits=sum(1 for k in keys if k in low); sys.exit(0 if p.exists() and len(text)>=200 and hits>=4 else 1)\""
      ],
      "expected_files": [
        "docs/summary/project_architecture.md"
      ]
    },
    {
      "task_id": "cross_feature_02",
      "category": "feature",
      "prompt": "Add push notification support by following existing source-code rules and extension patterns. Create src/cross_module_engine/processors/push_processor.py with class PushProcessor, update src/cross_module_engine/processors/__init__.py and src/cross_module_engine/runtime/registry.py to register it, and add tests/test_push_processor.py using unittest for successful dispatch.",
      "checks": [
        "uv run --python 3.12 python -m py_compile src/cross_module_engine/processors/push_processor.py src/cross_module_engine/runtime/registry.py tests/test_push_processor.py",
        "uv run --python 3.12 python -c \"from pathlib import Path; import re, sys; p=Path('src/cross_module_engine/processors/push_processor.py'); text=p.read_text(encoding='utf-8', errors='replace') if p.exists() else ''; ok=bool(re.search(r'class\\\\s+PushProcessor\\\\s*\\\\(\\\\s*ReliableProcessor\\\\s*\\\\)', text)); sys.exit(0 if ok else 1)\"",
        "uv run --python 3.12 python -c \"from pathlib import Path; import sys; text=Path('src/cross_module_engine/runtime/registry.py').read_text(encoding='utf-8', errors='replace'); sys.exit(0 if 'PushProcessor' in text else 1)\"",
        "uv run --python 3.12 python -m unittest discover -s tests -p \"test_push_processor.py\" -v"
      ],
      "expected_files": [
        "src/cross_module_engine/processors/push_processor.py",
        "src/cross_module_engine/processors/__init__.py",
        "src/cross_module_engine/runtime/registry.py",
        "tests/test_push_processor.py"
      ]
    },
    {
      "task_id": "cross_feature_03",
      "category": "feature",
      "prompt": "Create run_dispatch_demo.py that uses build_default_runtime, dispatches one email ticket, then attempts one push ticket. If push is not available, catch LookupError and continue. Print concise per-channel summary and include one interface-related detail in output text.",
      "checks": [
        "uv run --python 3.12 python -m py_compile run_dispatch_demo.py",
        "uv run --python 3.12 python -c \"from pathlib import Path; import sys; p=Path('run_dispatch_demo.py'); text=p.read_text(encoding='utf-8', errors='replace') if p.exists() else ''; req=['build_default_runtime','LookupError','email']; sys.exit(0 if p.exists() and all(x in text for x in req) else 1)\"",
        "uv run --python 3.12 python -c \"import runpy, sys; sys.path.insert(0, 'src'); runpy.run_path('run_dispatch_demo.py', run_name='__main__')\""
      ],
      "expected_files": [
        "run_dispatch_demo.py"
      ]
    },
    {
      "task_id": "cross_invariant_04",
      "category": "quality",
      "prompt": "Create docs/quality/invariants.md describing extension contracts and architectural invariants (delivery interface contract, cross-module processor hierarchy, registry contract, repository contract). Keep runtime behavior unchanged.",
      "checks": [
        "uv run --python 3.12 python -c \"from pathlib import Path; import sys; p=Path('docs/quality/invariants.md'); text=p.read_text(encoding='utf-8', errors='replace') if p.exists() else ''; low=text.lower(); sys.exit(0 if p.exists() and len(text)>=140 and 'deliveryinterface' in low and 'reliableprocessor' in low else 1)\"",
        "uv run --python 3.12 python -c \"import sys; sys.path.insert(0, 'src'); from cross_module_engine.runtime.registry import default_processors; from cross_module_engine.processors.reliable_processor import ReliableProcessor; from cross_module_engine.interfaces.delivery_interface import DeliveryInterface; ps=default_processors(); ok=isinstance(ps, list) and len(ps)>=3 and all(isinstance(p, ReliableProcessor) for p in ps) and all(isinstance(p.adapter, DeliveryInterface) for p in ps); sys.exit(0 if ok else 1)\"",
        "uv run --python 3.12 python -m unittest discover -s tests -p \"test_cross_module.py\" -v"
      ],
      "expected_files": [
        "docs/quality/invariants.md"
      ]
    }
  ]
}

